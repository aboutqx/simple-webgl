(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{67:function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var r=i(2),n=i(14),s=i(0),a=i(1);class o{constructor(){Object(r.a)(this,"ray",void 0),Object(r.a)(this,"aabb",void 0)}setRay(t,e,i,r,o){t-=s.b.getBoundingClientRect().left,e-=s.b.getBoundingClientRect().top;let c=2*t/s.b.clientWidth-1,u=1-2*e/s.b.clientHeight,l=(a.e.fromValues(c,u,1),a.f.fromValues(c,u,-1,1)),d=a.f.create();a.b.invert(i,i),a.b.multiply(d,i,l),d=a.f.fromValues(d[0],d[1],-1,0);let h=a.f.create();a.b.invert(r,r),a.b.multiply(h,r,d);let m=a.e.fromValues(h[0],h[1],h[2]);this.ray=new n.d(o,a.e.normalize(m,m))}castRay(t,e="AABB"){let i=!1;return"AABB"==e&&(this.aabb=n.a.fromVertices(t),i=o.rayAABB(this.aabb,this.ray)),i}static rayAABB(t,e){const i=t.min,r=t.max,n=(i[0]-e.origin[0])/(0==e.direction[0]?1e-5:e.direction[0]),s=(r[0]-e.origin[0])/(0==e.direction[0]?1e-5:e.direction[0]),a=(i[1]-e.origin[1])/(0==e.direction[1]?1e-5:e.direction[1]),o=(r[1]-e.origin[1])/(0==e.direction[1]?1e-5:e.direction[1]),c=(i[2]-e.origin[2])/(0==e.direction[2]?1e-5:e.direction[2]),u=(r[2]-e.origin[2])/(0==e.direction[2]?1e-5:e.direction[2]),l=Math.max(Math.max(Math.min(n,s),Math.min(a,o)),Math.min(c,u)),d=Math.min(Math.min(Math.max(n,s),Math.max(a,o)),Math.max(c,u));if(d<0)return!1;if(l>d)return!1;let h=l;return l<0&&(h=d),!0}static rayOBB(t,e){}static raySphere(){}static frustumPoint(t,e){const i=a.e.create();a.e.negate(i,e);for(let e=0;e<6;e++){if(t.planes[e].planeEquation(i)>0)return!1}return!0}static frustumSphere(t,e){const i=a.e.create();a.e.negate(i,e.origin);for(let r=0;r<6;r++){if(t.planes[r].planeEquation(i)-e.radius>0)return!1}return!0}static frustumAABB(t,e){}static frustumOBB(t,e){for(let t=0;t<6;t++)if(side-sphere.radius>0)return!1;return!0}static boxPlane(t,e){OBB}static ShpereSphere(t,e){const i=t.radius+e.radius;return a.e.dist(t.origin,e.origin)<i}static AABBAABB(t,e){const i=t.min,r=t.max,n=e.min,s=e.max;return i.x<=s.x&&r.x>=n.x&&i.y<=s.y&&r.y>=n.y&&i.z<=s.z&&r.z>=n.z}static PlanePlane(t,e){let i=a.e.cross(t,e);return 0!==a.e.length(i)}}},99:function(t,e,i){"use strict";i.r(e),i.d(e,"default",(function(){return l}));var r=i(43),n=i(0),s="#version 300 es\n#define GLSLIFY 1\nin vec3 position;\nin vec2 texCoord;\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\nout   vec2 vTexCoord;\nout vec3 Pos;\nvoid main(void){\n    vTexCoord = texCoord;\n    Pos = position;\n    gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(position, 1.0);\n}\n",a=i(1),o=i(67),c=i(42);function u(t,e){let i,r=[];for(let n=0;n<t.length;n++){i=a.f.fromValues(t[n][0],t[n][1],t[n][2],1);let s=a.f.create();a.f.transformMat4(s,i,e);let o=Array(...s).splice(0,3,1);r.push(o)}return r}class l extends r.a{constructor(){super()}init(){this.outlinePrg=this.compile(s,"#version 300 es\nprecision highp float;\n#define GLSLIFY 1\nin vec3 Pos;\nout vec4 outColor;\n\nvoid main()\n{\n  outColor = vec4(0.+Pos.x, 0.0, 0.0+Pos.z, .2);\n}"),this.prg=this.compile(s,"#version 300 es\nprecision highp float;\n#define GLSLIFY 1\nin   vec2 vTexCoord;\nout vec4 outColor;\nuniform sampler2D texture;\nuniform float lod;\nvoid main(void){\n\n    outColor = textureLod(texture, vTexCoord, lod);\n}\n"),this.intersect=new o.a}attrib(){this.cube=c.a.cube(1),this.torus=c.a.torus(64,64,.1,.4),this.cubeFrame=this.cube.boundingAABB().getFrame(),this.torusFrame=this.torus.boundingAABB().getFrame(),this.texture=getAssets.flower,this.texture.magFilter=n.c.LINEAR,this.texture.minFilter=n.c.NEAREST_MIPMAP_NEAREST}_setGUI(){this.addGUIParams({lod:1});let t=this.gui.addFolder("tetxureLod lod param");t.add(this.params,"lod",1,Math.log2(512)).step(1),t.open(),this.addRadio("NEAREST_MIPMAP_NEAREST",["NEAREST_MIPMAP_NEAREST","LINEAR_MIPMAP_LINEAR"],"filter type")}prepare(){n.c.enable(n.c.DEPTH_TEST),n.c.depthFunc(n.c.LESS),n.c.enable(n.c.STENCIL_TEST),n.c.stencilFunc(n.c.NOTEQUAL,1,255),n.c.stencilOp(n.c.KEEP,n.c.KEEP,n.c.REPLACE)}uniform(){const t=a.b.clone(this.camera.projectionMatrix),e=a.b.clone(this.camera.viewMatrix);this.intersect.setRay(this.mousePos.x,this.mousePos.y,t,e,this.camera.position),this.texture.bind(),this.params.LINEAR_MIPMAP_LINEAR?n.c.texParameteri(n.c.TEXTURE_2D,n.c.TEXTURE_MIN_FILTER,n.c.LINEAR_MIPMAP_LINEAR):n.c.texParameteri(n.c.TEXTURE_2D,n.c.TEXTURE_MIN_FILTER,n.c.NEAREST_MIPMAP_NEAREST)}render(){n.a.clear(),n.c.clear(n.c.COLOR_BUFFER_BIT|n.c.DEPTH_BUFFER_BIT|n.c.STENCIL_BUFFER_BIT),n.c.stencilMask(0);const t=a.b.create();a.b.translate(t,t,[-2.5,0,0]),this.intersect.castRay(u(this.cube.vertices,t))?this.renderOutline(t,this.cube):this.renderDefault(t,this.cube),a.b.identity(t),a.b.translate(t,t,[2,0,0]),this.intersect.castRay(u(this.torus.vertices,t))?this.renderOutline(t,this.torus):this.renderDefault(t,this.torus)}renderDefault(t,e){this.prg.use(),this.prg.style({texture:this.texture,uModelMatrix:t,lod:this.params.lod}),n.a.draw(e,!0)}renderOutline(t,e){n.c.stencilFunc(n.c.ALWAYS,1,255),n.c.stencilMask(255),this.renderDefault(t,e),n.c.stencilFunc(n.c.NOTEQUAL,1,255),n.c.stencilMask(0);a.b.scale(t,t,[1.1,1.1,1.1]),this.outlinePrg.use(),this.outlinePrg.style({uModelMatrix:t}),n.a.draw(e,!0)}}}}]);