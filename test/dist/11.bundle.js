(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{45:function(e,t,r){"use strict";var a=r(0),n=r(3);let s,i;t.a=class{constructor(e,t,r={},n=1){s=!window.useWebgl2&&a.c.getExtension("WEBGL_depth_texture"),this.width=e||a.b.width,this.height=t||a.b.height,this._numTargets=n,this._multipleTargets=n>1,1==r.hdr?this._parameters={internalFormat:a.c.RGBA16F,type:a.c.HALF_FLOAT,minFilter:r.minFilter,maxFilter:r.magFilter}:this._parameters=r,window.useWebgl2||(i=a.c.getExtension("WEBGL_draw_buffers")),this._multipleTargets&&this._checkMaxNumRenderTarget(),this._init()}_init(){if(this._initTextures(),this.frameBuffer=a.c.createFramebuffer(),a.c.bindFramebuffer(a.c.FRAMEBUFFER,this.frameBuffer),window.useWebgl2){if(0===this._numTargets)a.c.readBuffer(a.c.NONE),a.c.drawBuffers([a.c.NONE]);else{const e=[];for(let t=0;t<this._numTargets;t++)a.c.framebufferTexture2D(a.c.DRAW_FRAMEBUFFER,a.c.COLOR_ATTACHMENT0+t,a.c.TEXTURE_2D,this._textures[t].texture,0),e.push(a.c["COLOR_ATTACHMENT"+t]);a.c.drawBuffers(e)}a.c.framebufferTexture2D(a.c.DRAW_FRAMEBUFFER,a.c.DEPTH_ATTACHMENT,a.c.TEXTURE_2D,this.glDepthTexture.texture,0)}else{for(let e=0;e<this._numTargets;e++)a.c.framebufferTexture2D(a.c.FRAMEBUFFER,a.c.COLOR_ATTACHMENT0+e,a.c.TEXTURE_2D,this._textures[e].texture,0);if(this._multipleTargets){const e=[];for(let t=0;t<this._numTargets;t++)e.push(i[`COLOR_ATTACHMENT${t}_WEBGL`]);i.drawBuffersWEBGL(e)}s&&a.c.framebufferTexture2D(a.c.FRAMEBUFFER,a.c.DEPTH_ATTACHMENT,a.c.TEXTURE_2D,this.glDepthTexture.texture,0)}a.c.checkFramebufferStatus(a.c.FRAMEBUFFER)!=a.c.FRAMEBUFFER_COMPLETE&&console.log("gl.checkFramebufferStatus() returned "+status.toString(16)),a.c.bindTexture(a.c.TEXTURE_2D,null),a.c.bindRenderbuffer(a.c.RENDERBUFFER,null),a.c.bindFramebuffer(a.c.FRAMEBUFFER,null),this.clear()}_checkMaxNumRenderTarget(){const e=window.useWebgl2?a.c.getParameter(a.c.MAX_DRAW_BUFFERS):a.c.getParameter(i.MAX_DRAW_BUFFERS_WEBGL);this._numTargets>e&&(console.error("Over max number of draw buffers supported : ",e),this._numTargets=e)}_initTextures(){this._textures=[];for(let e=0;e<this._numTargets;e++){const e=this._createTexture();this._textures.push(e)}window.useWebgl2?this.glDepthTexture=this._createTexture(a.c.DEPTH_COMPONENT16,a.c.UNSIGNED_SHORT,a.c.DEPTH_COMPONENT,{minFilter:a.c.NEAREST,magFilter:a.c.NEAREST}):this.glDepthTexture=this._createTexture(a.c.DEPTH_COMPONENT,a.c.UNSIGNED_SHORT,a.c.DEPTH_COMPONENT,{minFilter:a.c.LINEAR})}_createTexture(e,t,r,s={}){const i=Object.assign({},this._parameters);i.internalFormat=e||i.internalFormat,i.format=r||i.format||a.c.RGBA,i.type=t||i.type||a.c.UNSIGNED_BYTE;for(const e in s)i[e]=s[e];return new n.a(null,i,this.width,this.height)}bind(e=!0){e&&a.c.viewport(0,0,this.width,this.height),a.c.bindFramebuffer(a.c.FRAMEBUFFER,this.frameBuffer),a.a.clear(0,0,0,1)}unbind(e=!0){e&&a.c.viewport(0,0,a.b.width,a.b.height),a.c.bindFramebuffer(a.c.FRAMEBUFFER,null),this._textures.forEach(e=>{e.generateMipmap()})}clear(e=0,t=0,r=0,n=0){this.bind(),a.a.clear(e,t,r,n),this.unbind()}get textures(){return this._textures}getTexture(e=0){return this._textures[e]}get depthTexture(){return this.glDepthTexture}get minFilter(){return this._textures[0].minFilter}set minFilter(e){this._textures.forEach(t=>{t.minFilter=e})}get magFilter(){return this._textures[0].magFilter}set magFilter(e){this._textures.forEach(t=>{t.magFilter=e})}get wrapS(){return this._textures[0].wrapS}set wrapS(e){this._textures.forEach(t=>{t.wrapS=e})}get wrapT(){return this._textures[0].wrapT}set wrapT(e){this._textures.forEach(t=>{t.wrapT=e})}showParameters(){this._textures[0].showParameters()}get numTargets(){return this._numTargets}}},51:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var a=r(2),n=r(5),s=r.n(n),i=r(16),o=r.n(i);class u{constructor(e,t){Object(a.a)(this,"_materials",{}),Object(a.a)(this,"materialsInfo",{}),Object(a.a)(this,"name",""),this.name=e,this.path=t}parse(e){var t,r,a,n,i,o,u,c,l,p=this;return s.a.async((function(h){for(;;)switch(h.prev=h.next){case 0:t=e.split("\n"),r={},a=/\s+/,n=0;case 4:if(!(n<t.length)){h.next=18;break}if(0!==(i=(i=t[n]).trim()).length&&"#"!==i.charAt(0)){h.next=9;break}return h.abrupt("continue",15);case 9:o=i.indexOf(" "),u=(u=o>=0?i.substring(0,o):i).toLowerCase(),c=(c=o>=0?i.substring(o+1):"").trim(),"newmtl"===u?(r={name:c},p.materialsInfo[c]=r):"ka"===u||"kd"===u||"ks"===u?(l=c.split(a,3),r[u]=[parseFloat(l[0]),parseFloat(l[1]),parseFloat(l[2])]):r[u]=c;case 15:n++,h.next=4;break;case 18:return h.next=20,s.a.awrap(p.setMaterials());case 20:return h.abrupt("return",p.materials);case 21:case"end":return h.stop()}}),null,null,null,Promise)}setMaterials(){var e,t,r,a,n=this;return s.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:i.t0=s.a.keys(n.materialsInfo);case 1:if((i.t1=i.t0()).done){i.next=58;break}t=i.t1.value,n._materials[t]={},i.t2=s.a.keys(n.materialsInfo[t]);case 5:if((i.t3=i.t2()).done){i.next=56;break}r=i.t3.value,a=n.materialsInfo[t][r],i.t4=r.toLowerCase(),i.next="kd"===i.t4?11:"ks"===i.t4?13:"map_ka"===i.t4?15:"map_kd"===i.t4?19:"map_ks"===i.t4?23:"norm"===i.t4?27:"map_bump"===i.t4||"bump"===i.t4?31:"map_ke"===i.t4?35:"map_d"===i.t4?39:"ns"===i.t4?44:"d"===i.t4?46:"tr"===i.t4?49:53;break;case 11:return n._materials[t].kd=a,i.abrupt("break",54);case 13:return n._materials[t].ks=a,i.abrupt("break",54);case 15:return i.next=17,s.a.awrap(n.setMapType("ambientMap",a));case 17:return n._materials[t].ambientMap=i.sent,i.abrupt("break",54);case 19:return i.next=21,s.a.awrap(n.setMapType("diffuseMap",a));case 21:return n._materials[t].diffuseMap=i.sent,i.abrupt("break",54);case 23:return i.next=25,s.a.awrap(n.setMapType("specularMap",a));case 25:return n._materials[t].specularMap=i.sent,i.abrupt("break",54);case 27:return i.next=29,s.a.awrap(n.setMapType("normalMap",a));case 29:return n._materials[t].normalMap=i.sent,i.abrupt("break",54);case 31:return i.next=33,s.a.awrap(n.setMapType("bumpMap",a));case 33:return n._materials[t].bumpMap=i.sent,i.abrupt("break",54);case 35:return i.next=37,s.a.awrap(n.setMapType("emissiveMap",a));case 37:return n._materials[t].emissiveMap=i.sent,i.abrupt("break",54);case 39:return i.next=41,s.a.awrap(n.setMapType("alphaMap",a));case 41:return n._materials[t].alphaMap=i.sent,params.transparent=!0,i.abrupt("break",54);case 44:return n._materials[t].shininess=parseFloat(a),i.abrupt("break",54);case 46:return(e=parseFloat(a))<1&&(n._materials[t].opacity=e),i.abrupt("break",54);case 49:return(e=1-(e=parseFloat(a)))>0&&(n._materials[t].opacity=1-e),i.abrupt("break",54);case 53:return i.abrupt("break",54);case 54:i.next=5;break;case 56:i.next=1;break;case 58:case"end":return i.stop()}}),null,null,null,Promise)}setMapType(e,t){var r,a,n=this;return s.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.split(/\s+/).pop(),e.next=3,s.a.awrap(o()(n.path+"/"+r));case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),null,null,null,Promise)}get materials(){return this._materials}set materials(e){this._materials=e}}},98:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return d}));var a=r(5),n=r.n(a),s=r(43),i=r(0),o=r(13),u=r(42),c=r(1),l=r(45),p=r(18),h=r(51);const m=[[-10,-10,-10],[0,-10,-10],[10,-10,-10],[-10,-10,0],[0,-10,0],[10,-10,0],[-10,-10,10],[0,-10,10],[10,-10,10]],f=[],g=[];for(let e=0;e<32;e++){const e=33*Math.random()-16,t=10*Math.random()-2,r=20*Math.random()-4;f.push([e,t,r]);const a=Math.random()/2+.5,n=Math.random()/2+.5,s=Math.random()/2+.5;g.push([a,n,s])}class d extends s.a{constructor(){super()}init(){i.a.applyHdrExtension(),this.prg=this.compile(o.c,"#version 300 es\nprecision highp float;\n#define GLSLIFY 1\n\nout vec4 outColor;\n\nin vec2 vTexCoord;\n\nuniform sampler2D gPosition;\nuniform sampler2D gNormal;\nuniform sampler2D gAlbedoSpec;\n\nstruct Light {\n    vec3 Position;\n    vec3 Color;\n\n    float Linear;\n    float Quadratic;\n};\nconst int NR_LIGHTS = 100;\n\nuniform Light lights[NR_LIGHTS];\nuniform vec3 viewPos;\n\nvoid main() {\n    vec3 vPosition = texture(gPosition, vTexCoord).rgb;\n    vec3 Normal = texture(gNormal, vTexCoord).rgb;\n    vec3 Diffuse = texture(gAlbedoSpec, vTexCoord).rgb;\n    float Specular = texture(gAlbedoSpec, vTexCoord).a;\n\n    // then calculate lighting as usual\n    vec3 lighting  = Diffuse * .1; // hard-coded ambient component\n    vec3 viewDir  = normalize(viewPos - vPosition);\n    for(int i = 0; i < NR_LIGHTS; ++i)\n    {\n        // diffuse\n        vec3 lightDir = normalize(lights[i].Position - vPosition);\n        vec3 diffuse = max(dot(Normal, lightDir), 0.0) * Diffuse * lights[i].Color;\n        // specular\n        vec3 halfwayDir = normalize(lightDir + viewDir);\n        float spec = pow(max(dot(Normal, halfwayDir), 0.0), 16.0);\n        vec3 specular = lights[i].Color * spec * Specular;\n        // attenuation\n        float distance = length(lights[i].Position - vPosition);\n        float attenuation = 1.0 / (1.0 + lights[i].Linear * distance + lights[i].Quadratic * distance * distance);\n        diffuse *= attenuation;\n        specular *= attenuation;\n        lighting += diffuse + specular;\n    }\n    outColor = vec4(lighting, 1.0);\n}\n"),this.gBufferPrg=this.compile("#version 300 es\n#define GLSLIFY 1\n\nlayout (location = 0) in vec3 position;\nlayout (location = 1) in vec3 normal;\nlayout (location = 2) in vec2 texCoord;\n\nout vec3 vPosition;\nout vec2 vTexCoord;\nout vec3 Normal;\n\nuniform mat4 mMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvoid main()\n{\n    vec4 worldPos = mMatrix * vec4(position, 1.0);\n    vPosition = vec3(worldPos);\n\n    vTexCoord = texCoord;\n\n    mat3 normalMatrix = transpose(inverse(mat3(mMatrix)));\n    Normal = normalMatrix * normal;\n\n    gl_Position = uProjectionMatrix * uViewMatrix * worldPos;\n}\n","#version 300 es\nprecision highp float;\n#define GLSLIFY 1\nlayout (location = 0) out vec3 gPosition;\nlayout (location = 1) out vec3 gNormal;\nlayout (location = 2) out vec4 gAlbedoSpec;\n\nin vec2 vTexCoord;\nin vec3 vPosition;\nin vec3 Normal;\n\nuniform sampler2D diffuseMap1;\nuniform sampler2D specularMap1;\n\nvoid main()\n{\n    // store the fragment position vector in the first gbuffer texture\n    gPosition = vPosition;\n    // also store the per-fragment normals into the gbuffer\n    gNormal = normalize(Normal);\n    // and the diffuse per-fragment color\n    gAlbedoSpec.rgb = texture(diffuseMap1, vTexCoord).rgb;\n    // store specular intensity in gAlbedoSpec's alpha component\n    gAlbedoSpec.a = texture(specularMap1, vTexCoord).r;\n}\n"),this.lampPrg=this.basicColor()}attrib(){var e,t=this;return n.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return t.cube=u.a.sphere(.3,40),t.quad=u.a.bigTriangle(),r.next=4,n.a.awrap(new h.a("nanosuit.mtl","./assets/models/nanosuit").parse(getAssets.nanosuitMTL));case 4:e=r.sent,(new p.a).load("./assets/models/nanosuit/nanosuit.obj",r=>{t.nanosuit=p.a.parse(r,e)});case 6:case"end":return r.stop()}}),null,null,null,Promise)}prepare(){this.mrt=new l.a(i.b.width,i.b.height,{hdr:!0},3),this.orbital.target=[0,-1,0],this.orbital.offset=[1,3,0],this.orbital.radius=28}uniform(){}render(){if(this.mrt.bind(),i.a.clear(),this.gBufferPrg.use(),this.nanosuit)for(let e=0;e<m.length;e++){let t=c.b.create();c.b.translate(t,t,m[e]),this.gBufferPrg.style({mMatrix:t}),i.a.draw(this.nanosuit)}this.mrt.unbind(),i.a.clear(),this.frameBufferGUI.textureList=[{texture:this.mrt.getTexture(0)}],this.prg.use(),this.prg.style({gPosition:this.mrt.getTexture(0),gNormal:this.mrt.getTexture(1),gAlbedoSpec:this.mrt.getTexture(2),viewPos:this.camera.position},!0);for(let e=0;e<f.length;e++)this.prg.style({[`lights[${e}].Position`]:f[e],[`lights[${e}].Color`]:g[e],[`lights[${e}].Linear`]:.1,[`lights[${e}].Quadratic`]:.12});i.a.draw(this.quad)}}}}]);